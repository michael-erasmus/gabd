var countdown = {
	init: function() {
  	countdown.remaining = countdown.max - $(countdown.obj).val().length;
  	if (countdown.remaining > countdown.max) {
  		$(countdown.obj).val($(countdown.obj).val().substring(0,countdown.max));
  	}
  	$(countdown.obj).siblings(".remaining").html(countdown.remaining + " characters remaining.");
 	},
	max: null,
  remaining: null,
  obj: null
};

$(document).ready(function(){					
	//Validation
	$(".suggestion-form").validate({
		//set the rules for the field names
		rules: {
			by: {
				required: true,
				minlength: 2,
				maxlenght: 20
			},
			text: {
				minlength: 2,
				maxlength: 20
			},
			//set messages to appear inline
			messages: {
				by: "Please enter your name",
				text: "Please enter your text"
			}
		}	
	});
									
	//CountDown								
	$(".countdown").each(function() {
    $(this).focus(function() {
    	var c = $(this).attr("class");
      countdown.max = parseInt(c.match(/limit_[0-9]{1,}_/)[0].match(/[0-9]{1,}/)[0]);
      countdown.obj = this;
      iCount = setInterval(countdown.init,500);
    }).blur(function() {
        countdown.init();
        clearInterval(iCount);
    });
	});
});

